# --- Persistent Connection Configuration for Temp Table Testing ---
# This configuration demonstrates how to use temporary tables with persistent connections
[general]
database=ich21@zdev21_tcp
test_capture_entries_count=6
persistent_connection=1
separator=;

# Test sequence: Create temp table, use it, then clean up
[transaction00]
sql=CREATE TEMP TABLE ich21@zdev21_tcp:temp_customers ( \
    kundennr INT, \
    vertriebszentrumnr INT, \
    nameapo VARCHAR(40), \
    ort VARCHAR(32), \
    skdkundeaegesperrt INT, \
    idfnr INT, \
    regionnr INT \
);

[transaction01]
sql=INSERT INTO ich21@zdev21_tcp:temp_customers ( \
    kundennr, vertriebszentrumnr, nameapo, ort, skdkundeaegesperrt, idfnr, regionnr \
) VALUES (10001, 12, 'Apotheke A', 'Berlin', 0, 5001, 1);

[transaction02]
sql=INSERT INTO ich21@zdev21_tcp:temp_customers ( \
    kundennr, vertriebszentrumnr, nameapo, ort, skdkundeaegesperrt, idfnr, regionnr \
) VALUES (10002, 13, 'Apotheke B', 'Munich', 0, 5002, 2);

[transaction03]
sql=INSERT INTO ich21@zdev21_tcp:temp_customers ( \
    kundennr, vertriebszentrumnr, nameapo, ort, skdkundeaegesperrt, idfnr, regionnr \
) VALUES (10003, 14, 'Apotheke C', 'Hamburg', 1, 5003, 3);

[transaction04]
sql=SELECT (kundennr || ';' || vertriebszentrumnr || ';' || nameapo || ';' || ort \
|| ';' || skdkundeaegesperrt || ';' || idfnr || ';' || regionnr) AS row \
FROM ich21@zdev21_tcp:temp_customers
header=kundennr;vertriebszentrumnr;nameapo;ort;skdkundeaegesperrt;idfnr;regionnr

[transaction05]
sql=SELECT (ort || ';' || COUNT(*)) AS row \
FROM ich21@zdev21_tcp:temp_customers \
GROUP BY ort;
header=ort;customer_count

[transaction06]
sql=UPDATE ich21@zdev21_tcp:temp_customers \
SET skdkundeaegesperrt = 0 \
WHERE kundennr = 10003;

[transaction07]
sql=SELECT (kundennr || ';' || nameapo || ';' || ort || ';' || skdkundeaegesperrt) AS row \
FROM ich21@zdev21_tcp:temp_customers \
WHERE skdkundeaegesperrt = 0;
header=kundennr;nameapo;ort;status

[transaction08]
sql=DROP TABLE ich21@zdev21_tcp:temp_customers;