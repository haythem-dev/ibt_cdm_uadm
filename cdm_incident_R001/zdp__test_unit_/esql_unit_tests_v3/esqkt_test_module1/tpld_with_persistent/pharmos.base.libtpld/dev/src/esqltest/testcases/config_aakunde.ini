[general]
database=ich21@zdev21_tcp
separator=;

# --- aakunde test case: simulate customer selection, info retrieval, and tour data ---
# Create temp table for customers
[transaction00]
sql=CREATE TABLE ich21@zdev21_tcp:temp_customers (\
    kundennr INT,\
    vertriebszentrumnr INT,\
    nameapo VARCHAR(40),\
    ort VARCHAR(32),\
    skdkundeaegesperrt INT,\
    idfnr INT,\
    regionnr INT\
);

# Insert sample customers
[transaction01]
sql=INSERT INTO ich21@zdev21_tcp:temp_customers (\
    kundennr, vertriebszentrumnr, nameapo, ort, skdkundeaegesperrt, idfnr, regionnr\
) VALUES (10001, 12, 'Apotheke A', 'Berlin', 0, 5001, 1);
[transaction02]
sql=INSERT INTO ich21@zdev21_tcp:temp_customers (\
    kundennr, vertriebszentrumnr, nameapo, ort, skdkundeaegesperrt, idfnr, regionnr\
) VALUES (10002, 12, 'Apotheke B', 'Hamburg', 0, 5002, 2);
[transaction03]
sql=INSERT INTO ich21@zdev21_tcp:temp_customers (\
    kundennr, vertriebszentrumnr, nameapo, ort, skdkundeaegesperrt, idfnr, regionnr\
) VALUES (10003, 13, 'Apotheke C', 'Munich', 0, 5003, 1);

# Create temp table for customer tours
[transaction04]
sql=CREATE TABLE ich21@zdev21_tcp:temp_customer_tours (\
    tourid INT,\
    kundennr INT,\
    vertriebszentrumnr INT,\
    datum INT,\
    ort VARCHAR(32),\
    kippzeit INT\
);

# Insert sample customer tour data
[transaction05]
sql=INSERT INTO ich21@zdev21_tcp:temp_customer_tours (\
    tourid, kundennr, vertriebszentrumnr, datum, ort, kippzeit\
) VALUES (20001, 10001, 12, 20240601, 'Berlin', 10);
[transaction06]
sql=INSERT INTO ich21@zdev21_tcp:temp_customer_tours (\
    tourid, kundennr, vertriebszentrumnr, datum, ort, kippzeit\
) VALUES (20002, 10002, 12, 20240602, 'Hamburg', 0);
[transaction07]
sql=INSERT INTO ich21@zdev21_tcp:temp_customer_tours (\
    tourid, kundennr, vertriebszentrumnr, datum, ort, kippzeit\
) VALUES (20003, 10003, 13, 20240603, 'Munich', 5);

# Complex SELECT: join customers and tours, show customers with kippzeit > 0
[transaction08]
sql=SELECT (c.kundennr || ';' || c.nameapo || ';' || t.tourid || ';' || t.datum || ';' || t.ort || ';' || t.kippzeit) AS result \
    FROM ich21@zdev21_tcp:temp_customers c \
    JOIN ich21@zdev21_tcp:temp_customer_tours t ON c.kundennr = t.kundennr \
    WHERE t.kippzeit > 0 \
    ORDER BY t.datum;
header=KundenNr;NameApo;TourID;Datum;Ort;Kippzeit
separator=;
limit=10

# Logic: count tours per customer
[transaction09]
sql=SELECT (kundennr || ';' || COUNT(tourid)) AS result \
    FROM ich21@zdev21_tcp:temp_customer_tours \
    GROUP BY kundennr \
    ORDER BY kundennr;
header=KundenNr;TourCount
separator=;
limit=10

# Drop temp tables
[transaction10]
sql=DROP TABLE ich21@zdev21_tcp:temp_customer_tours;
[transaction11]
sql=DROP TABLE ich21@zdev21_tcp:temp_customers;
