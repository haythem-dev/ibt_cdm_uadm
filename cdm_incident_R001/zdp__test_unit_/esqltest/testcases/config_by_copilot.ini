[general]
database=ich21@zdev21_tcp
separator=;
test_capture_entries_count=0

# Test case: Permanent table creation, insert, select, and drop
[transaction00]
sql=CREATE TABLE ich21@zdev21_tcp:temp_esqltest (\
    id INT,\
    name VARCHAR(40),\
    value INT\
);

[transaction01]
sql=INSERT INTO ich21@zdev21_tcp:temp_esqltest (id, name, value) VALUES (1, 'IBM Example', 100);

[transaction02]
sql=INSERT INTO ich21@zdev21_tcp:temp_esqltest (id, name, value) VALUES (2, 'Resource Test', 200);

[transaction03]
sql=INSERT INTO ich21@zdev21_tcp:temp_esqltest (id, name, value) VALUES (3, 'Temporary Row', 300);

[transaction04]
sql=SELECT (id || ';' || name || ';' || value) AS result FROM ich21@zdev21_tcp:temp_esqltest ORDER BY id;
header=id;name;value
separator=;
limit=10

[transaction05]
sql=DROP TABLE ich21@zdev21_tcp:temp_esqltest;

# --- Complex IBM-style test case ---
# Create two tables
[transaction06]
sql=CREATE TABLE ich21@zdev21_tcp:dept (\
    dept_id INT,\
    dept_name VARCHAR(40)\
);

[transaction07]
sql=CREATE TABLE ich21@zdev21_tcp:emp (\
    emp_id INT,\
    emp_name VARCHAR(40),\
    salary INT,\
    dept_id INT\
);

# Insert departments
[transaction08]
sql=INSERT INTO ich21@zdev21_tcp:dept (dept_id, dept_name) VALUES (1, 'Sales');
[transaction09]
sql=INSERT INTO ich21@zdev21_tcp:dept (dept_id, dept_name) VALUES (2, 'Engineering');

# Insert employees
[transaction10]
sql=INSERT INTO ich21@zdev21_tcp:emp (emp_id, emp_name, salary, dept_id) VALUES (101, 'Alice', 70000, 1);
[transaction11]
sql=INSERT INTO ich21@zdev21_tcp:emp (emp_id, emp_name, salary, dept_id) VALUES (102, 'Bob', 80000, 2);
[transaction12]
sql=INSERT INTO ich21@zdev21_tcp:emp (emp_id, emp_name, salary, dept_id) VALUES (103, 'Charlie', 75000, 1);

# Complex SELECT: join, group by, aggregate
[transaction13]
sql=SELECT (d.dept_name || ';' || COUNT(e.emp_id) || ';' || AVG(e.salary)) AS result \
    FROM ich21@zdev21_tcp:dept d \
    LEFT JOIN ich21@zdev21_tcp:emp e ON d.dept_id = e.dept_id \
    GROUP BY d.dept_name \
    ORDER BY d.dept_name;
header=Department;EmployeeCount;AverageSalary
separator=;
limit=10

# Subquery: employees with above average salary
[transaction14]
sql=SELECT (emp_name || ';' || salary) AS result \
    FROM ich21@zdev21_tcp:emp \
    WHERE salary > (SELECT AVG(salary) FROM ich21@zdev21_tcp:emp) \
    ORDER BY salary DESC;
header=Employee;Salary
separator=;
limit=10

# Drop tables
[transaction15]
sql=DROP TABLE ich21@zdev21_tcp:emp;
[transaction16]
sql=DROP TABLE ich21@zdev21_tcp:dept;

# --- Additional complex test case: window functions and self-join ---
# Create a sales table
[transaction17]
sql=CREATE TABLE ich21@zdev21_tcp:sales (\
    sale_id INT,\
    sale_date INT,\
    amount INT,\
    customer_id INT\
);

# Insert sales data
[transaction18]
sql=INSERT INTO ich21@zdev21_tcp:sales (sale_id, sale_date, amount, customer_id) VALUES (1, 20240601, 500, 101);
[transaction19]
sql=INSERT INTO ich21@zdev21_tcp:sales (sale_id, sale_date, amount, customer_id) VALUES (2, 20240602, 700, 102);
[transaction20]
sql=INSERT INTO ich21@zdev21_tcp:sales (sale_id, sale_date, amount, customer_id) VALUES (3, 20240603, 300, 101);
[transaction21]
sql=INSERT INTO ich21@zdev21_tcp:sales (sale_id, sale_date, amount, customer_id) VALUES (4, 20240604, 900, 103);

# Window function: running total per customer
[transaction22]
sql=SELECT (customer_id || ';' || sale_date || ';' || amount || ';' || \
    SUM(amount) OVER (PARTITION BY customer_id ORDER BY sale_date)) AS result \
    FROM ich21@zdev21_tcp:sales \
    ORDER BY customer_id, sale_date;
header=CustomerID;SaleDate;Amount;RunningTotal
separator=;
limit=10

# Self-join: find pairs of sales by same customer
[transaction23]
sql=SELECT (a.sale_id || ';' || b.sale_id || ';' || a.customer_id) AS result \
    FROM ich21@zdev21_tcp:sales a \
    JOIN ich21@zdev21_tcp:sales b \
    ON a.customer_id = b.customer_id AND a.sale_id < b.sale_id \
    ORDER BY a.customer_id, a.sale_id, b.sale_id;
header=SaleID1;SaleID2;CustomerID
separator=;
limit=10

# Drop sales table
[transaction24]
sql=DROP TABLE ich21@zdev21_tcp:sales;
